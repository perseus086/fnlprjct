import urllib
import couchdb
import json

def get_jsons(id_, db_author_pub):
    value = 0
    while True:
        URL = 'https://api.datamarket.azure.com/MRC/MicrosoftAcademic/v2/Paper_Author?$filter=AuthorID%20eq%20'+id_+'&$skip='+str(value)+'&$format=json'
        data = urllib.urlopen(URL).read()
        print URL
        json_data = json.loads(data)
        print json_data
        i = 0
        for each_json in json_data['d']['results']:
            print each_json
            dictionary = {}
            dictionary['paper_id'] = str(each_json['PaperID'])
            dictionary['author_id'] = str(each_json['AuthorID'])
            print i, dictionary
            try:
                db_author_pub.save(dictionary)
            except:
                print 'error saving'
            i+=1
        value += 100
        if json_data['d']['results'] != []:
            break
    return


db_name = 'mas_authors'
db_save = 'mas_author_publication'
server = couchdb.Server('http://localhost:5984/')
try:
    db_author = server[db_name]
except:
    print 'error connecing to DB'
    exit()
print "Connected to", db_name

try:
    db_author_pub = server[db_save]
except:
    print 'error connecting to DB', db_save
    exit()
print "Connected to", db_save

author_id_list = [53738460,53738743,53739540,53740392,53740440,53741191,53741193,53741227,53741228,53742337,53744760,53745408,53747955,53748348,53748596,53748800,53751166,53752126,53752131,53752708,53752981,53755122,53755688,53755700,53755931,53756285,53756547,53756623,53756834,53759170,53759576,53759934,53760148,53760199,53761860,53763013,53765044,53769117,53769193,53769484,53770890,53770912,53771309,53772836,53774404,53775375,53776666,53777346,53777452,53780002,53781322,53782004,53783204,53783867,53785272,53785527,53786131,53786412,53787486,53787639,53788703,53790465,53791380,53792344,53793767,53793779,5379443,53795705,53796414,53796439,53797911,53798307,53798548,53798913,53798985,53799020,53801354,53803769,53806252,53806385,53806871,53807903,53807966,53808289,53810358,53810957,53811269,53812147,53813596,53814788,53815097,53816851,53819854,53819928,53820810,53822386,53823804,53826887,53829964,53830283,53831846,53831858,53833669,53834969,53835954,53836072,53836504,53837427,53837845,53839701,53840877,53841347,53842840,53844077,53844609,53847659,53847714,53847790,53849020,53849245,53849593,53850557,53852983,53853859,53855332,53856975,53859356,53862302,53864444,53864734,53867016,53867457,53868598,53870337,53871410,53871486,53871773,53872374,5387289,53873484,53873503,53873585,53874654,53874964,53875191,53876902,53877262,5387738,53877781,53878129,53878163,53879956,53880112,53880599,53880962,53881234,53881857,53882118,53883600,53883935,53884323,53885531,53888144,53889050,53891139,53891172,53891703,53892409,53892643,53896816,53896819,53896821,53897981,53898079,53898344,53899274,53900702,53902366,53904459,53906213,53906979,53907963,53908173,53908415,53910888,53913247,53913632,53913667,53913889,53914491,53916221,53917209,53917740,53923323,53924384,53925211,53928072,53929550,53931463,53932523,53933169,53934497,53934876,53936295,53936715,53938595,53939124,53939659,53940846,53941789,53943233,53944770,53945645,53945651,53945798,53947561,53948413,53949584,53949696,53950521,53950998,53951735,53953229,53957577,53957578,53958355,53959698,53960714,53960984,53962192,53967304,53967533,53967601,53969244,53971357,53972829,53973266,53973875,53973918,53975530,53975659,53976482,53981359,53985815,53987203,53987222,53988493,53989586,53990563,53991608,53992071,53992924,53993268,53993517,53993593,53994558,53999929,54000490,54001174,54002416,54002671,54003238,54003880,54003881,54004050,54006200,54007336,54008259,54012586,54014126,54014622,54019722,54020835,54024746,54025480,54026763,54027361,54027798,54028823,54029176,54035126,54037185,54038667,54039275,54040200,54040594,54041854,54043478,54044961,54046180,54050290,54051668,54051729,54054588,54056259,54060190,54061187,54061254,54061430,54065730,54065965,54065969,54066236,54068842,54069191,54069754,54071404,54071409,54074777,54075775,54077583,54078888,54081132,54082001,54084342,54084443,54084679,54086020,54089977,54090248,54090654,54091576,54094490,54098128,54098998,54099585,54099664,54100402,54100685,54103695,54104353,54104645,54105087,54109268,54109328,54109823,54110299,54110630,54111534,54112788,54113098,54113305,54115408,54116971,54119568,54120696,54121603,54122914,54124428,54124552,54124688,54128245,54128398,54129589,5413098,541322,54132722,54133440,54135355,54138537,54141362,54141378,54142441,54142960,54144564,54146003,54146611,54148983,54150120,54150594,54152219,54155298,54156865,54156944,54157199,54158748,54158797,54160188,54160781,54162195,54163257,54164909,54168043,54168696,54170007,54173149,54173925,54175325,54178121,5418041,54180763,54182541,54182658,54185733,54185876,54186691,54186799,54186800,54189650,54192265,54192547,54194222,54195435,54196567,54198413,54198416,54199968,54200592,54204472,54205862,54206950,54208081,54211178,54214118,54214266,54215109,54216837,54216977,54218031,54218627,54219778,54221222,54222795,54223068,5422387,54224322,54226784,54227866,54230788,54231164,54233119,54233601,54234495,54236376,54238234,54246914,54247460,54250065,54250862,54253269,54258929,54262741,54263025,54263250,54264239,54268776,5427306,54273379,54274834,54275395,54275579,54275819,5427602,54276489,54277760,54277965,54278179,54278960,54280791,54285781,5428672,54287692,54287748,54289875,54290576,54292184,54293750,54294231,54294790,54297280,54297769,54298043,54298377,54298453,54300826,54301027,54301764,54303073,54305360,54308424,54309531,54309927,54310790,54313903,54316654,54316888,54317274,54319678,54319698,54319774,54319779,54319785,54319790,54320090,54320724,54323041,54323688,54325523,54327927,54327975,54328574,54329605,54330281,54334744,54336064,54337627,54339799,5434008,54341586,54341986,54344491,54344757,54347621,54348317,54353716,5435711,54357135,54357174,54357305,54357681,54358909,54361093,54361473,54362411,54363816,54363936,54364239,54366229,54367339,54368861,54371279,54371896,54374030,54374081,54374512,54374675,54375408,54376571,54377468,54377676,54379007,54380715,54381060,54381099,54385442,54387669,54388215,54388219,54390634,54392252,54394406,54394540,54395224,54396115,54397373,54397729,54399013,54399981,54401515,54403384,54407023,54408058,54408479,54409095,54418553,54419051,54422650,54422756,5442353,54425972,54428573,54428909,54429065,54430054,54432663,54435143,54437769,54440654,54440890,54442150,54442611,54442897,54443716,54444378,54446144,54447461,54451700,54453437,54456719,54457235,54458372,54461230,54463876,54463877,54465604,54466294,54466442,54471278,54471399,54476291,54477004,54479337,54484864,54485179,54485388,54487745,54490478,54492352,54492593,54494354,54494625,5450228,54502864,54503075,54504014,54506821,54511944,54513234,54513508,54513623,54514215,54515006,54515275,54515887,54515997,54516661,54516786,54517371,54523338,54524736,54527807,54529111,54530670,54530762,54532589,54533472,54536437,54538063,54539107,54539888,54544297,54546058,54546277,54549938,54550539,54555560,54557960,54561787,54565142,54565351,54565839,54566668,54566767,54567010,54567341,54568903,54571167,54571633,54572300,54573349,54573759,54576215,54578216,54582801,54583403,54583942,54587431,54589073,54589232,54590495,54591575,54592078,54596481,54596492,54598153,54599044,54603608,54603617,54603631,54603826,54605153,54605521,54605733,54607191,54607849,54609418,54610044,54610045,54611315,54611483,54612703,54613040,54614156,54614835,54614940,54616982,54617323,54617667,54620231,54620475,54621591,54622104,54623005,54625224,54626973,54627591,54630721,54633840,54636842,54637234,54637748,54641158,54641332,54641935,54644554,54645117,54647072,54647457,54648789,54649641,54650397,54656111,5465758,54657978,54662450,54662707,54662989,54663571,54664304,54665589,54665793,54668692,54669,54670788,54670969,54671063,54671093,54674798,54677228,54679771,54681325,54681369,54681939,54682748,54684372,54684961,54685844,54689484,54691492,54693698,54694658,54695793,54698365,54699480,54700155,54700159,54703716,54704426,54704906,54708863,54709544,54711088,54712098,54714248,54715694,54716103,54722066,54724559,54726514,54726640,54728220,54728252,54729102,54729104,54729295,54729817,54731718,54732362,54733018,54735106,54736332,54738554,54738980,54739375,5474172,54742195,54742434,54742738,54743510,54744143,54745277,54745664,54747935,54748478,54748583,54749419,54749787,54753885,54754834,54759165,54761677,54762568,54762643,54764529,54765754,54765860,54766550,54768511,54771132,54771188,54771764,54773314,54774171,54774762,54775774,54775995,54783477,54785749,54786656,54787218,54788448,54788455,54788501,54789060,54789061,54789833,54791410,54793553,54793978,54795625,54799865,54802324,54804031,54807063,54811084,54815105,54816529,54817000,54822053,54823903,54824390,54824744,54825089,54831484,54833570,54835215,54835604,54835762,54836728,54840518,54840802,54841683,54843759,54843859,54844674,54844685,54846328,54849537,54849705,54850342,54850512,54851874,54852296,54852317,54854884,54857658,54859134,54860874,54863053,54866738,54868212,54869758,54871845,54877069,54877396,54877967,54880343,54881545,54884650,54885618,54887236,54888281,54890597,54890677,54890814,54892157,54893342,5489361,54895493,54895658,54898112,54903404,54903849,54905355,54905581,54909228,54911039,54912113,54912680,54912898,54915134,54915433,54916184,54916770,54916778,54918348,54918488,54919122,54921255,54921891,54922197,54922270,54922490,54923496,54925040,54925559,54927659,54934452,54936839,54937110,54938396,54938829,54938830,54939256,54939342,54944776,54945579,54946430,54946919,54947774,54949447,54950613,54950635,54956397,54959910,54960133,54960135,54960467,54970330,54971752,54973934,54974680,54977482,54978659,54978994,54979223,54984345,54984521,54984850,54987254,54993367,54994153,54994213,54996477,54996593,55002686,55005389,55007045,55007532,55008504,55008788,55010714,55012037,55013291,55013294,55015043,55015103,55017175,55022477,55023661,55024975,55028156,55029533,55029566,55029820,55031426,55031447,55033228,55034274,55035257,55036229,55036649,55038343,55039121,55040608,55041569,55041796,55042052,55042616,55043900,55047014,55047440,55048668,55052166,55052613,55052696,55053369,55053817,55053988,55054376,55058331,55058376,55059985,55062279,55063711,55065125,55066472,55067576,55068964,55069099,55070833,55070899,55071022,55071741,55073261,55074531,55077077,55078873,55081008,55082985,55083134,55084300,55084367,55084599,55085810,55087141,55087884,5508808,55090708,55090977,55091455,55091967,55094376,55095661,55095865,55098294,55099588,55103674,55104602,55105259,55108039,55108464,55108905,55110964,55111961,55113839,55117395,55117698,55118633,55119745,55119927,55122625,55122687,55129903,55132460,55135825,55136370,55139956,55140728,55140741,55142804,55143691,55145117,55146660,55146663,55147593,55147999,55149329,55149332,55151177,55152914,55153866,55156286,55157216,55158481,55162868,55163740,55164092,55172698,55173053,55174593,55179202,55181298,55181638,55181740,55182612,55184182,55184199,55187597,55190705,55192961,55196724,55199912,55202165,55202801,55203174,55204724,55204761,55205440,55205818,55206292,55206488,55207646,55208312,55211509,55213268,55215421,55216510,55220529,55220900,55221232,55222301,55224129,55224506,55225133,55225655,55226197,55227123,55234772,55235993,55237711,55239549,55239575,55240008,55241071,55241156,55242580,55244559,55246027,55248402,55250212,55251851,55253807,55254317,55255808,55257739,55263355,55263371,55263818,55264300,55264390,55265471,55268383,55268790,55269064,55269150,55269439,55269865,55269973,55269985,55270200,55272095,55272314,55274997,55275650,55275801,55276006,55276260,55276874,55277143,55282615,55284086,55284860,55286726,55289474,55290737,55294153,55294926,55295318,55297892,55298793,55299536,55300256,55304128,55305741,55308915,55311530,55316107,55317008,55319825,55320349,55325576,55326093,55327059,55334167,55337150,55338339,55339695,55339728,55340817,55341815,55342595,55354146,55364002,55370116,55373790,55373828,55374748,55376553,55380554,55382347,55385699,55386756,55391953,55396446,55396613,55397891,55402423,55402896,55405044,55405045,55405373,55406460,55406728,55416629,55417229,55419598,55419987,55421408,55421934,55422532,55423244,55424365,55431272,55435591,55436295,55438155,55443733,55444642,55444731,5544709,55454396,55455870,55460542,55463683,55466580,55476380,55476459,55483577,55486777,55487485,55487540,55489516,55490357,55492674,5549315,5549317,55502937,55503010,55507713,55508061,55512643,55513698,55514309,55514598,55515442,55518465,55530148,55532510,55533651,55536011,55537014,55537586,55542496,55542508,55542918,55544509,55546014,55549835,55550003,55550594,55551541,55554999,55560632,55562843,55565029,55565032,55567123,55568286,55568594,55570242,55570588,55570893,55574036,55574470,55574896,55587750,55589019,55589739,55598447,55598708,55599903,55602387,55607031,55608853,55608942,55612203,55612790,55612990,55613005,55615413,55621695,55630856,55633704,55634365,55634816,55634915,55638401,55640298,55640477,55640568,55641197,55642614,55643495,55646882,55647672,55647925,55648769,55650688,55651171,55651600,55652950,55654553,55658028,55659175,55661058,55661739,55663052,55664625,55666465,55666860,55669141,55677950,55681018,55681695,55683525,55683588,55683881,55684126,55684127,55684504,55685114,55685168,55688577,55690459,55692065,55692611,55693952,55698184,55698827,55699920,55702965,55703482,55703614,55706214,55711175,55714520,55714791,55715410,55720214,55722993,55725246,55726425,55727557,55728170,55730801,55733616,55734101,55734951,55735470,55736995,55739882,55740413,55744078,55744293,55747492,55748343,55749409,55750629,55750868,55751043,55756101,55763105,55764946,55765616,55765874,55767122,55768283,55770711,55779655,55780255,55781215,55786365,55787282,55794095,55797574,55798851,55799292,55801642,55804412,55809917,55815276,55815802,55823940,55828039,55828470,55829920,55830185,55834975,55835535,55837160,55837844,55840257,55846823,55849381,55854278,55858451,55859700,55860662,55861156,55861238,5586225,55862309,55866889,55872314,55886431,55887145,55889259,55890035,55903714,55904471,55906840,55910041,55910087,55910353,55910669,55910670,55914516,55916726,55920888,55920934,55923929,55924716,55926077,55926852,55928916,55930146,55932051,55932514,55932888,55934842,55935617,55936122,55937124,55937205,55938733,55939063,55939771,55939772,55940168,55944734,55944735,55946111,55947158,55947159,55948387,55953156,55953469,55953884,55956463,55958064,55958850,55961472,55963692,55963859,55965645,55968469,55968751,55970683,55971268,55973275,55974318,55975581,55975582,55975790,55977961,55978650,55978712,55979940,55980569,55980928,55984984,55986064,55986148,55987354,55987378,55987834,55988657,55988766,55988928,55989362,55989789,55990355,55991690,55991834,55993019,55993027,55994084,55994085,55995701,55996747,5599692,56000385,56001199,56002017,56004160,56004600,56009055,56009066,56016818,56016919,56017160,56018944,56019450,56020150,56021002,56021321,5602200,56023048,56024981,56026425,56026446,56029031,56029091,56029410,56030746,56030859,56030905,56033423,56035065,56035156,56036153,56036267,56039617,56039851,56046522,56047200,56047850,56051914,56052481,56053175,56055818,56058452,56064241,56068737,56069781,56074837,56074982,56075562,56075892,56081760,56082139,56087730,56088218,56088328,56089014,56091038,56091263,56091397,56091398,56093718,56095615,56095756,56101306,56101821,56102324,56103429,56104506,56104798,56106464,56109266,56111273,56112658,56113906,56114242,56114632,56115476,5611739,56118084,56119942,56120933,56121782,56122734,56122935,56123390,5612344,56125390,56126182,5612629,56127685,56129128,56129834,56129835,56129836,56133294,56135104,56135338,56138576,56139448,56141764,56144977,56145412,56145624,56149879,56150577,56154683,56154975,56156169,56156170,56157730,56158206,56158994,56160618,56163785,56164490,56164507,56172790,56174437,56178280,56179115,5618443,56185509,56185791,56186072,56188285,56190579,56191900,56191981,56191983,56191984,56192339,56193095,56195242,56197248,56197423,56201148,56204128,56206226,56208702,56213318,56214296,56214920,56215953,56219624,56219901,56229485,56230163,56232910,56234807,56235203,56235320,56237420,56237788,56240313,56242063,56242523,56242781,56244934,56247707,56247802,56248443,56249191,56249978,56256364,5625691,56257811,56262186,56267823,56271565,56272481,56272639,56279808,56280935,56283462,56283785,56286148,56289039,56290844,56291174,56291236,56292083,56293400,56293401,56293840,56294790,56294792,56297855,56298167,56298182,56298556,56300241,5630057,56306814,56306907,56309277,56309737,56311659,56314456,56315168,56320979,56321239,56321270,56323335,56326757,56326899,56327974,56332613,56333027,56333210,5633548,5633549,56338546,5633885,56341124,56341501,56341790,56345500,56346789,56347513,56352415,56354278,56357793,56360375,56363491,56363512,56372076,5637311,56373903,56374072,56374350,56374973,56375033,56378809,56379044,56379225,56381137,56383682,56386246,56386686,56390168,56391250,56396015,56396192,56398348,5639881,56399744,56401310,5640622,56407671,56409656,56412451,56415378,56417231,56423033,56426483,56430702,56431070,56432382,56432398,56432953,56434052,56434378,56435744,56436647,56440317,56445678,56446269,56447827,56451914,56453287,56457812,56458620,56459804,56460287,56461067,56462518,56463459,56466141,56467538,56475598,56475599,56476200,56479705,56481777,56483949,56486792,56488512,56492753,56495116,56502271,56503008,56503681,56504582,56504712,56509659,56514429,56514536,56514537,56515197,56517142,56519691,56521400,56521401,56521402,56521822,56521843,5652324,56525029,56525136,56525632,56527757,56529073,56529205,56531787,56537451,56537584,56537873,56538345,56538730,56539953,56542839,56545484,56549575,56550352,56551191,56551818,56553300,56555129,56564859,56570511,56570972,56572351,5657257,56577974,56580300,56585460,56586998,56588134,56589136,56594814,56595694,56598528,56599633,56599702,56600159,56600891,56601961,56603906,56606814,56607355,56607592,56607946,56609146,56610750,56610922,56611969,56612835,56613752,56615112,56615699,56618245,56618881,56618883,56619663,5662153,56621691,56622546,56622558,56624403,56626705,56628528,56632878,56634623,56635858,56637435,56640690,56641548,56648879,56653456,56656133,56656360,56656654,56657639,56659877,56660677,56666525,56667813,56670783,56674090,56674123,56675248,56675395,56678334,56678538,56679087,56690410,56699474,56700170,56702130,56704009,56708943,56709106,56712153,56715376,56715793,56716574,56722287,56725199,56726821,56730144,56736106,56736109,56736113,56736116,56737037,56738577,56740235,56743458,56747486,56750087,56750871,56752662,56754708,56757420,5676026,56760574,56761153,56762621,56762980,56763089,5676410,56766621,56767394,56768693,56771434,56773058,56775949,56777512,56782246,56785041,56786626,56787147,56788783,56792539,56793662,56794339,56795873,56798450,56799356,56800146,56803894,56810794,56813664,56816368,56816594,56822363,56824718,56825612,56826292,56831714,56831965,56832223,56834290,56834614,56836768,56838887,56840372,56841801,56844943,56844975,56845757,5684860,56849678,56850716,56851149,56851584,56852736,56854163,56862407,56863147,56867671,56869211,56870066,56873529,56878409,56882365,56930733,56930833,56930835,56945371,56950344,56951881,56951882,56952563,56953586,5695531,56962629,56962899,56964340,56969619,56976257,56978941,56982651,56983635,56993067,57014887,5709867,57206,5727079,573795,5743701,5748979,5759714,5764823,576995,5778100,5787273,5796392,5827743,5835097,5845682,5856609,5859789,5866954,5887302,5891352,589927,5903087,5906763,5907370,5911095,591204,5927460,5934972,5943177,5947063,5951409,5952693,5957096,5957152,596809,5973363,5975874,5983695,5986202,5988851,5992919,5993283,6017384,6029370,6038908,6039208,604018,6046848,6056067,607176,6078396,608222,6100174,6114354,6122719,6124910,6133938,6148019,6170257,6173657,617699,619286,619968,620729,6233996,6241851,6265366,6271734,6271853,6288917,630838,6308469,6322266,6325182,6325652,6330530,6338823,6348793,6348794,6350856,6351292,6352475,6371747,6377029,6378686,6382496,6383704,6384951,6384954,638542,6386202,6388085,6400237,6409497,6411800,6413745,6413929,6420059,6422799,6429681,643460,6434970,6436263,644084,6451976,6455922,6473027,6475356,6476182,6478981,6478982,6478983,6495264,6507924,6511036,6511037,6522265,6525211,6525574,652599,6534831,6537358,6550120,6550121,6550122,6567271,6568110,6576400,6595109,6596088,6597073,6597473,6600154,6614735,6615588,6618676,6618678,6619736,6619737,6620776,6625908,6635459,663729,6639995,6643810,6643811,6648441,6657766,6675607,6680898,668215,67841,679225,6828001,6828010,6829476,684223,6842776,6848345,6870436,6871633,687832,688535,6886650,6900639,6906465,691043,6911865,6920323,6924081,6924082,6924083,6939121,6943225,6948106,6958312,6961779,6963020,6965249,6991361,6996212,6996484,6996485,6997965,701288,7026307,7028883,7039034,704056,7040995,704715,705596,7079635,7102492,7106197,7111306,7131777,7141118,7143816,7143817,7183436,7186243,7188986,720894,7213427,7225060,7235696,7243438,7251590,7260509,7279954,7289447,7307111,7307840,7309736,7311620,7324714,7324715,7324716,7342373,7353605,7361783,736581,7379728,7384757,7388238,739367,7403725,741289,742053,7425010,7425203,7425496,7431451,7455537,7457522,7458003,7461453,746197,7465552,746821,7481237,7484304,7487935,7496496,7497903,7501667,7512357,7514319,7524034,7528759,7532256,7551141,7551308,7556443,756584,7571990,7575198,7576798,7602313,7603557,7607333,7626064,763644,7639087,764261,7648522,7658451,7659677,7669144,767066,7678179,7683634,7686552,7696724,7698258,7700034,7707722,7713739,7716160,7716161,772816,7738525,7746609,7746633,775540,7758020,7790395,7809641,7810234,7831059,784530,785092,785270,785271,7862652,7865601,7869360,7878817,7878836,7888143,7907196,7938645,7938855,7951878,795747,79621,7963134,7963135,7990560,799132,8001636,8003332,8004002,8022317,802517,803333,8041998,8046235,8048023,8058005,8069745,8070077,8077456,808139,8089797,8093799,8096389,8101357,8111042,8125109,8125828,813467,8141382,814343,8146250,8150555,8150934,8150935,8157324,8159053,815996,8165552,8166999,8172138,8176906,8177119,8178092,8186018,8195997,8213096,8216746,8218153,8225404,8238632,8245007,8254926,8273060,828139,82843,8292415,8311711,8315848,8361257,8364739,8368065,83805,8399656,8417489,8453174,8466579,8480554,8491863,8494563,8506891,8516447,8538700,8552618,8554641,8560827,8564919,8565682,8568814,8573580,8578413,8580401,8599471,8611990,8613661,8618966,8623932,8629584,8640613,8657633,8665903,8694385,8694434,8694727,869511,8703439,8739029,8759698,8766634,8775917,8800292,8803972,8804375,8804376,8814308,8820605,8823345,8824742,8825295,8835653,883796,8847793,8857058,8868134,8868908,8869226,8870707,8874527,8887025,8891323,8892663,8894084,8895375,89026,8904950,8905311,8906628,8916825,8920435,8935760,8936181,8936872,8951478,8953205,8953240,8965502,8965530,8971586,897532,8975947,8982681,8982682,898583,898737,9003746,9007181,9012730,9018673,9033624,9038,9046706,9106284,910827,9112839,912084,91393,9145197,9151928,9186251,918989,9194520,9196766,9197123,9200387,9202821,9205421,9208318,9220903,9224619,9226928,9228535,9251456,9251802,9263246,9267831,9268018,9268708,9269611,9270410,9272875,9277818,9291676,9292038,932825,9346271,9355219,93565,93569,9367754,9372799,9375644,9379379,9380480,9383039,9390661,9393587,9393982,9393983,9401778,9403643,9404086,9414057,9420271,9421299,9422977,942353,9424489,9425988,9427371,9437721,9438557,9440008,94472,9453454,9453809,9454078,9474366,9490636,9491542,9505567,9505568,9514353,9522476,9539620,9547103,9571241,9580398,9583102,9584351,9592446,960177,9605446,9608250,9636777,9675875,9677280,9681558,969058,979046,99839,999687]

# author_id_list = []
# db_author.view('author/id', startkey=10, endkey= 20)
# print db_author
# for each_data in db_author:
#     author_id_list.append(each_data)
#     print each_data
i = 0
while author_id_list != []:
    id_ = author_id_list.pop(0)
    print i, id_
    get_jsons(str(id_), db_author_pub)
    i += 1

